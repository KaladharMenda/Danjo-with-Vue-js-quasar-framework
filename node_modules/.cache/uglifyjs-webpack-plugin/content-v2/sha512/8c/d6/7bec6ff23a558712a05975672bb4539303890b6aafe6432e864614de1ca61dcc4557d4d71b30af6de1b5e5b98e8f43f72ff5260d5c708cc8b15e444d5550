{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"70014bb8\"],{\"3dd7\":function(e,t,a){\"use strict\";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"HOME PAGE-CONTENT\"},[a(\"q-card\",{staticClass:\"bg-white card-styl\"},[a(\"q-select\",{attrs:{options:e.locationDropDown,\"float-label\":\"Select Source\"},on:{input:e.updateReceivemastersDt},model:{value:e.Source,callback:function(t){e.Source=t},expression:\"Source\"}}),e.Source?a(\"q-table\",{attrs:{data:e.tableData,columns:e.columns,title:\"Received STN\",color:\"black\",filter:e.filter,separator:e.separator,\"row-key\":\"name\",loading:e.loading},scopedSlots:e._u([{key:\"top-right\",fn:function(t){return[a(\"q-search\",{staticClass:\"col-12\",model:{value:e.filter,callback:function(t){e.filter=t},expression:\"filter\"}})]}},{key:\"top-left\",fn:function(t){return[a(\"q-btn\",{attrs:{icon:\"refresh\"},on:{click:e.updateReceivemastersDt}})]}},{key:\"header\",fn:function(t){return a(\"q-tr\",{},[a(\"q-th\",{key:\"received_item_count\",attrs:{props:t}},[e._v(e._s(t.cols[0].label))]),a(\"q-th\",{key:\"destinationCode\",attrs:{props:t}},[e._v(\"Created By\")]),a(\"q-th\",{key:\"totalBags\",attrs:{props:t}},[e._v(e._s(t.cols[3].label))]),a(\"q-th\",{key:\"totalItems\",attrs:{props:t}},[e._v(e._s(t.cols[4].label))]),a(\"q-th\",{key:\"date\",attrs:{props:t}},[e._v(e._s(t.cols[8].label))]),a(\"q-th\",{key:\"status\",attrs:{props:t}},[e._v(e._s(t.cols[9].label))])],1)}},{key:\"body\",fn:function(t){return a(\"q-tr\",{staticClass:\"cursor-pointer\",staticStyle:{\"font-size\":\"15px\"},attrs:{props:t}},[a(\"q-td\",{key:\"received_item_count\",attrs:{props:t},nativeOn:{click:function(a){e.rowClick(t.row)}}},[e._v(e._s(t.row.name))]),a(\"q-td\",{key:\"destinationCode\",attrs:{props:t}},[e._v(e._s(t.row.created_by))]),a(\"q-td\",{key:\"totalBags\",attrs:{props:t}},[e._v(e._s(t.row.received_bag_count)+\"/\"+e._s(t.row.totalBags))]),a(\"q-td\",{key:\"totalItems\",attrs:{props:t}},[e._v(e._s(t.row.received_item_count)+\"/\"+e._s(t.row.totalItems))]),a(\"q-td\",{key:\"date\",attrs:{props:t}},[e._v(e._s(t.row.date))]),a(\"q-td\",{key:\"status\",attrs:{props:t}},[e._v(e._s(t.row.status))]),a(\"q-td\",[a(\"q-btn\",{staticClass:\"q-mr-xs\",attrs:{color:\"secondary\",icon:\"visibility\",size:\"sm\"},on:{click:function(a){e.navigateToReport(t.row)}}})],1)],1)}}])}):e._e()],1),a(\"q-modal\",{attrs:{\"no-backdrop-dismiss\":\"\",\"no-esc-dismiss\":\"\",\"content-css\":{padding:\"25px\",minWidth:\"100vw\",height:\"100%\"}},model:{value:e.barcodePdfShowModal,callback:function(t){e.barcodePdfShowModal=t},expression:\"barcodePdfShowModal\"}},[a(\"div\",{staticClass:\"row\"},[a(\"div\",{staticClass:\"q-display-1 q-mb-md\",staticStyle:{\"font-size\":\"25px\"}},[e._v(\"Download Barcodes\")]),a(\"div\",{staticClass:\"col\",attrs:{align:\"right\"}},[a(\"q-btn\",{attrs:{flat:\"\",round:\"\",dense:\"\"},on:{click:function(t){e.closeBarcodePdfIframe()}}},[e._v(\"X\")])],1)]),a(\"iframe\",{staticStyle:{width:\"100%\",height:\"87%\"},attrs:{src:e.pdfUrl}})]),a(\"q-modal\",{attrs:{\"no-backdrop-dismiss\":\"\",\"no-esc-dismiss\":\"\",\"content-css\":{padding:\"20px 20px 20px 20px\",minWidth:\"70vw\"}},model:{value:e.eventsModal,callback:function(t){e.eventsModal=t},expression:\"eventsModal\"}},[a(\"div\",{attrs:{align:\"center\"}},[a(\"h6\",[e._v(\"STN Number: \"),a(\"b\",{staticStyle:{\"margin-left\":\"15px\"}},[e._v(e._s(e.currentStn.name))]),a(\"q-btn\",{staticStyle:{float:\"right\",\"margin-top\":\"-5px\"},attrs:{flat:\"\",round:\"\",dense:\"\"},on:{click:function(t){e.closePopup()}}},[e._v(\"X\")])],1)]),a(\"div\",{attrs:{align:\"center\"}},[a(\"h6\",{staticClass:\"text-positive\"},[e._v(\"Received No.of Items: \"),a(\"b\",{staticStyle:{\"margin-left\":\"15px\"}},[e._v(e._s(e.currentStn.received_item_count))])]),a(\"h6\",{staticClass:\"text-positive\"},[e._v(\"Received No.of Masters: \"),a(\"b\",{staticStyle:{\"margin-left\":\"15px\"}},[e._v(e._s(e.currentStn.received_bag_count))])])]),a(\"div\",{staticClass:\"row\"},[a(\"div\",{staticClass:\"col-md-5 col-sm-5 col-xs-10 q-mt-md\",attrs:{align:\"left\"}},[a(\"span\",[e._v(\"Expected No.of masters:\")])]),a(\"div\",{staticClass:\"col-md-1 col-sm-1 col-xs-2 q-pr-md q-mt-md\",attrs:{align:\"right\"}},[a(\"span\",[e._v(e._s(e.currentStn.expmasters))])]),a(\"div\",{staticClass:\"col-md-5 col-sm-5 col-xs-10 q-mt-md\",attrs:{align:\"left\"}},[a(\"span\",[e._v(\"Expected No.of Items:\")])]),a(\"div\",{staticClass:\"col-md-1 col-sm-1 col-xs-2 q-pr-md q-mt-md\",attrs:{align:\"right\"}},[a(\"span\",[e._v(e._s(e.currentStn.expItems))])])]),a(\"hr\",{staticStyle:{margin:\"25px 0\"}}),a(\"div\",{staticClass:\"row\"},[a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"}),e.mbagselected?e._e():a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"},[a(\"q-toggle\",{attrs:{label:\"Scan Bag Only\"},on:{input:e.toggleBagScan},model:{value:e.scanBagAlone,callback:function(t){e.scanBagAlone=t},expression:\"scanBagAlone\"}}),a(\"q-field\",[a(\"q-input\",{ref:\"scannedMBag\",attrs:{type:\"text\",\"float-label\":\"Scan Master Bag *\"},on:{keyup:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.getMbagDetails(t):null}},model:{value:e.scannedMBag,callback:function(t){e.scannedMBag=t},expression:\"scannedMBag\"}})],1)],1),e.mbagselected?a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"},[a(\"q-field\",[a(\"q-input\",{ref:\"scannedItem\",attrs:{type:\"text\",\"float-label\":\"Scan Item Id / Packet Id *\"},on:{keyup:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.receiveItem(t):null}},model:{value:e.scannedItem,callback:function(t){e.scannedItem=t},expression:\"scannedItem\"}})],1),a(\"q-btn\",{staticStyle:{width:\"100%\",\"margin-bottom\":\"2px\"},attrs:{label:\"Close Master Bag\"},on:{click:e.closeMBag}})],1):e._e(),a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12\"})])]),a(\"q-modal\",{attrs:{\"no-backdrop-dismiss\":\"\",\"no-esc-dismiss\":\"\",\"content-css\":{padding:\"25px\",minWidth:\"25vw\",height:\"50px;\"}},model:{value:e.duplicateItem,callback:function(t){e.duplicateItem=t},expression:\"duplicateItem\"}},[e.alreadyScannedItem?a(\"p\",{staticStyle:{\"font-size\":\"17px\"}},[e._v(\"Item already scanned.\")]):e._e(),e.noScannedCarton?a(\"p\",{staticStyle:{\"font-size\":\"17px\"}},[e._v(\"Given carton no is not available in the list.\")]):e._e(),e.noScannedItem?a(\"p\",{staticStyle:{\"font-size\":\"17px\"}},[e._v(\"Given item no is not available in the list.\")]):e._e(),a(\"q-btn\",{attrs:{color:\"primary\",label:\"Ok\"},on:{click:function(t){e.duplicateItem=!1,e.cursorFocus()}}})],1)],1)},s=[];n._withStripped=!0;a(\"cadf\"),a(\"456d\"),a(\"55dd\"),a(\"ac6a\"),a(\"7f7f\");var r=a(\"9523\"),o=a.n(r),c=a(\"c604\"),i=a(\"62a9\"),l=a(\"66d7\"),d=a(\"7b38\"),u=a(\"53fe\"),m=a(\"0952\"),v=a(\"6186\"),f=a(\"bc3a\"),p=a.n(f),b=a(\"133b\"),_={components:{QTable:c[\"a\"],QTh:i[\"a\"],QTr:l[\"a\"],QTd:d[\"a\"],QTableColumns:u[\"a\"],QModal:m[\"a\"],QSearch:v[\"a\"]},created:function(){var e=document.getElementById(\"myTopnav\");null!==e&&(e.className=\"topnav\")},mounted:function(){var e=this;firebase.auth().onAuthStateChanged(function(t){firebase.database(app2).ref(\"UserDetails\").child(t.uid).once(\"value\",function(t){e.currentUserDetails=t.val(),e.$store.dispatch(\"example/fetchUserLocId\",t.val().location_id),e.Source=t.val().location_id,e.getLocations(t.val().location_id)})})},data:function(){var e;return e={filter:\"\",currentStn:{},eventsModal:!1,separator:\"cell\",loading:!1,scan_master:\"\",scan_item:\"\",tableData:[],stnNumberForPopUp:\"\",expmasters:\"\",expItems:\"\",receivedmasters:0,receivedItems:0,readonly:0,itemReadonly:1,confirmDisabled:!0,endCartonDisable:!1,duplicateItem:!1,alreadyScannedItem:!1,noScannedItem:!1,noScannedCarton:!1,recCount:0,currentScannedItemLocation:\"\",scannedItem:\"\",scannedMBag:\"\",scanBagAlone:0,mbagselected:0},o()(e,\"receivedItems\",0),o()(e,\"firsttoggle\",1),o()(e,\"receBagCount\",0),o()(e,\"barcodePdfShowModal\",!1),o()(e,\"pdfUrl\",!1),o()(e,\"afterScanData\",{stn_number:\"\",masters:{}}),o()(e,\"dataForCurrentStn\",{stn_number:\"\",masters:{}}),o()(e,\"columns\",[{name:\"stnNumer\",required:!0,label:\"STN Number\",align:\"center\",field:\"name\",sortable:!0},{name:\"destinationCode\",label:\"Destination Code\",align:\"center\",field:\"destinationCode\",sortable:!0},{name:\"sourceCode\",label:\"Source Code\",align:\"center\",field:\"sourceCode\",sortable:!0},{name:\"totalBags\",label:\"No of masters\",align:\"center\",field:\"totalBags\",sortable:!0},{name:\"totalItems\",label:\"No of Items\",align:\"center\",field:\"totalItems\",sortable:!0},{name:\"vehicle_no\",label:\"Vehicle No\",align:\"center\",field:\"vehicle_no\",sortable:!0},{name:\"received_bag_count\",label:\"Received masters\",align:\"center\",field:\"received_bag_count\",sortable:!0},{name:\"received_item_count\",label:\"Received Items\",align:\"center\",field:\"received_item_count\",sortable:!0},{name:\"date\",label:\"Date\",align:\"center\",field:\"date\",sortable:!0},{name:\"status\",label:\"Status\",align:\"center\",field:\"status\",sortable:!0}]),o()(e,\"locationDropDown\",[]),o()(e,\"Source\",\"\"),e},methods:{convertDate:function(e){var t=new Date(e),a=t.getMonth()+1,n=t.getDate(),s=t.getFullYear();n<10&&(n=\"0\"+n),a<10&&(a=\"0\"+a);var r=n+\"-\"+a+\"-\"+s;return r},navigateToReport:function(e){var t=this;t.showBarcodePdfInIframe(\"/#/reconciliation_report/stNo/\"+e.name+\"/\"+e.sourceCode)},getLocations:function(e){var t=this;firebase.database().ref(\"Locations\").once(\"value\",function(a){a.forEach(function(a){e!==a.val().id&&t.locationDropDown.push({label:a.val().name,value:a.key})}),t.Source=t.locationDropDown[0].value,t.updateReceivemastersDt()})},updateReceivemastersDt:function(){var e=this;e.tableData=[],e.loading=!0,p.a.get(baseUrlForBackend+\"/stn/get?source=\"+e.Source).then(function(t){e.tableData=[],e.loading=!1,t.data.forEach(function(t){e.tableData.push({name:t.stn_number,created_by:t.created_by,destinationCode:t.destination,source:t.source,status:t.status,totalBags:t.no_of_bags,totalItems:t.no_of_items,vehicleNo:t.vehicle_no,uploaded_cartons:t.no_of_bags,date:t.created_at,type:t.type,received_bag_count:t.bags_received,received_item_count:t.items_received})}),e.tableData=e.tableData.sort(function(e,t){return new Date(t.date)-new Date(e.date)})})},rowClick:function(e){var t=this;console.log(e),setTimeout(function(){t.mbagselected?t.$refs.scannedItem.focus():t.$refs.scannedMBag.focus()},600),t.currentStn=e,t.currentStn.stn_number=e.name,t.currentStn.expItems=(t.currentStn.totalItems?t.currentStn.totalItems:0)-(t.currentStn.received_item_count?t.currentStn.received_item_count:0),t.currentStn.expmasters=(t.currentStn.totalBags?t.currentStn.totalBags:0)-(t.currentStn.received_bag_count?t.currentStn.received_bag_count:0),t.eventsModal=!0},closePopup:function(){var e=this;e.eventsModal=!1,e.mbagselected&&(e.mbagselected=0,e.closeMBag()),e.currentStn={}},getMbagDetails:function(){var e=this,t=e.scannedMBag;firebase.database().ref(\"StnMasterBagMapping/\"+t).once(\"value\",function(a){if(a.val()){var n=Object.keys(a.val())[0],s=a.val()[n].bag_src;firebase.database().ref(\"StnCartonItemData/\"+s+\"/\"+n).once(\"value\",function(a){if(a.val())if(\"Dispatched\"===a.val().status||\"Partially Received\"===a.val().status)if(a.val().destination_code===e.currentUserDetails.location_id)firebase.database().ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/\"+t).once(\"value\",function(r){r.val()?\"created\"===r.val().status&&(firebase.database().ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/\"+t+\"/status\").set(\"open\"),firebase.database().ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/received_bag_count\").set(a.val().received_bag_count?a.val().received_bag_count+1:1),e.currentStn.received_bag_count=a.val().received_bag_count?a.val().received_bag_count+1:1,e.currentStn.expmasters=e.currentStn.expmasters-1):(firebase.database().ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/\"+t+\"/status\").set(\"open\"),firebase.database().ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/received_bag_count\").set(a.val().received_bag_count?a.val().received_bag_count+1:1),e.currentStn.received_bag_count=a.val().received_bag_count?a.val().received_bag_count+1:1,e.currentStn.expmasters=e.currentStn.expmasters-1)}),e.scanBagAlone?(b[\"a\"].create({message:e.scannedMBag+\"has been received\",position:\"center\",timeout:80,type:\"positive\",color:\"positive\",textColor:\"black\"}),e.scannedMBag=\"\"):(e.mbagselected=1,e.currentStn.Source=s,e.currentStn.MasterBag=t,setTimeout(function(){e.$refs.scannedItem.focus()},200));else{var r=new Audio(\"/statics/beep1.mp3\");r.play(),b[\"a\"].create({message:\"This Carton is meant for location \"+a.val().destination_code,position:\"center\",timeout:80}),e.$refs.scannedMBag.focus()}else{var o=new Audio(\"/statics/beep1.mp3\");o.play(),b[\"a\"].create({message:\"Current Status :\"+a.val().status,position:\"center\",timeout:80}),e.$refs.scannedMBag.focus()}})}else{var r=new Audio(\"/statics/beep1.mp3\");r.play(),b[\"a\"].create({message:\"Invalid Carton ID\",position:\"center\",timeout:80}),e.$refs.scannedMBag.focus()}})},showBarcodePdfInIframe:function(e){var t=this;t.barcodePdfShowModal=!0,t.pdfUrl=e},closeBarcodePdfIframe:function(){var e=this;e.barcodePdfShowModal=!1},receiveItem:function(){var e=this,t=e.scannedItem;firebase.database(app2).ref(\"MasterBagItemMapping/\"+e.currentStn.stn_number+\"/\"+e.currentStn.MasterBag+\"/item_code/\"+t).once(\"value\",function(a){if(a.val())if(\"received\"===a.val().status){var n=new Audio(\"/statics/beep1.mp3\");n.play(),b[\"a\"].create({message:\"Item Already Received\",position:\"center\",timeout:80}),firebase.database().ref(\"RtoandReturns/\"+t+\"/stn\").set(null),firebase.database().ref(\"RtoandReturns/\"+t+\"/mbag\").set(null)}else firebase.database(app2).ref(\"MasterBagItemMapping/\"+e.currentStn.stn_number+\"/\"+e.currentStn.MasterBag+\"/item_code/\"+t).update({status:\"received\",received_by:e.$store.state.example.userName,received_at:new Date}),e.currentStn.received_item_count+=1,e.currentStn.totalItems===e.currentStn.received_item_count?firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/status\").set(\"Received\"):firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/status\").set(\"Partially Received\"),firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/received_item_count\").set(e.currentStn.received_item_count),e.currentStn.expItems=e.currentStn.expItems-1,firebase.database().ref(\"RtoandReturns/\"+t+\"/stn\").set(null),firebase.database().ref(\"RtoandReturns/\"+t+\"/mbag\").set(null);else{var s=new Audio(\"/statics/beep1.mp3\");s.play(),b[\"a\"].create({message:\"Item Not Found\",position:\"center\",timeout:80})}}),setTimeout(function(){e.scannedItem=\"\"},600)},closeMBag:function(){var e=this,t=e.currentStn.stn_number,a=e.currentStn.MasterBag,n=e.currentStn.Source;firebase.database().ref(\"MasterBagItemMapping/\"+t+\"/\"+a+\"/item_code\").once(\"value\",function(s){var r=s.numChildren(),o=0,c=\"\";s.forEach(function(e){\"received\"===e.val().status&&(o+=1)}),c=r===o?\"closed\":\"open\",firebase.database().ref(\"StnCartonItemData/\"+n+\"/\"+t+\"/\"+a+\"/status\").set(c),e.scannedItem=\"\",e.scannedMBag=\"\",e.mbagselected=0})},toggleBagScan:function(){this.firsttoggle&&(this.firsttoggle=0,this.scanBagAlone=!this.scanBagAlone),this.$refs.scannedMBag.focus()}}},g=_,S=(a(\"6da2\"),a(\"2877\")),h=Object(S[\"a\"])(g,n,s,!1,null,null,null);h.options.__file=\"receivedStn.vue\";t[\"default\"]=h.exports},\"548c\":function(e,t,a){},\"6da2\":function(e,t,a){\"use strict\";var n=a(\"548c\"),s=a.n(n);s.a}}]);","extractedComments":[]}