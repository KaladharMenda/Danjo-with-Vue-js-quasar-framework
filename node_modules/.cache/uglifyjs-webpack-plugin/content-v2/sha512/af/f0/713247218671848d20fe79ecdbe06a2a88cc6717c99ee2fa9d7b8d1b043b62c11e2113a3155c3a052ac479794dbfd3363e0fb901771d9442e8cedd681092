{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"2d0cf38a\"],{6390:function(e,t,a){\"use strict\";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"About\"},[a(\"q-card\",{staticClass:\"bg-white card-styl\"},[a(\"div\",{staticClass:\"row\"},[a(\"div\",{staticClass:\"col-lg-12 col-md-12 col-sm-12 col-xs-12\"},[a(\"h3\",{staticClass:\"inner_head_styl\"},[e._v(\"Warehouse Segregation\")])])]),a(\"div\",{staticClass:\"row\",attrs:{align:\"center\"}},[a(\"div\",{staticClass:\"col-lg-12 col-md-12 col-sm-12 col-xs-12\"},[e.locationLoader?e._e():a(\"span\",{staticClass:\"text-positive q-ml-md scannedItemLocation\",class:e.colorOfItemLocation},[e._v(e._s(e.currentScannedItemLocation))]),!e.locationLoader&&e.errorMsg?a(\"span\",{staticClass:\"text-negative q-ml-md text-center scannedItemError\"},[e._v(\"Item Received, Segregation Data Not Available\")]):e._e(),e.locationLoader?a(\"q-spinner\",{staticStyle:{margin:\"0 auto\"},attrs:{color:\"green\",size:\"40px\"}}):e._e()],1)]),a(\"div\",{staticClass:\"row\"},[a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"}),a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"},[a(\"q-toggle\",{attrs:{label:\"Scan Bag Only\"},on:{input:e.toggleBagScan},model:{value:e.scanBagAlone,callback:function(t){e.scanBagAlone=t},expression:\"scanBagAlone\"}}),a(\"q-toggle\",{attrs:{label:\"Scan Item Only\"},on:{input:e.toggleItemScan},model:{value:e.scanItemAlone,callback:function(t){e.scanItemAlone=t},expression:\"scanItemAlone\"}})],1),a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"})]),a(\"div\",{staticClass:\"row\"},[a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"}),e.mbagselected||e.scanItemAlone?e._e():a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"},[a(\"q-field\",[a(\"q-input\",{ref:\"scannedMBag\",attrs:{type:\"text\",pattern:\"\\\\d*\",\"float-label\":\"Scan Master Bag *\"},on:{keyup:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.getMbagDetails(t):null}},model:{value:e.scannedMBag,callback:function(t){e.scannedMBag=t},expression:\"scannedMBag\"}})],1)],1),e.mbagselected||e.scanItemAlone?a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12 scannedItemTop\"},[a(\"q-field\",[a(\"q-input\",{ref:\"scannedItem\",attrs:{type:\"text\",\"float-label\":\"Scan Item Id / Packet Id *\"},on:{keyup:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.receiveItem(t):null}},model:{value:e.scannedItem,callback:function(t){e.scannedItem=t},expression:\"scannedItem\"}})],1),e.scanItemAlone?e._e():a(\"q-btn\",{staticStyle:{width:\"100%\",\"margin-bottom\":\"2px\"},attrs:{label:\"Close Master Bag\"},on:{click:e.closeMBag}})],1):e._e(),a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12\"})]),e.mbagselected?a(\"div\",{staticClass:\"row\"},[a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12\"}),a(\"div\",{staticClass:\"col-lg-4 col-md-4 col-sm-6 col-xs-12\"},[a(\"table\",{staticClass:\"q-table\"},[a(\"tr\",[a(\"th\",{staticClass:\"text-left\"},[e._v(\"Total / Received Master Bags:\")]),a(\"td\",{staticClass:\"text-right\"},[e._v(e._s(e.currentStn.received_bag_count)+\"/\"),a(\"span\",[e._v(e._s(e.currentStn.totalBags))])])]),a(\"tr\",[a(\"th\",{staticClass:\"text-left\"},[e._v(\"Total / Received Items:\")]),a(\"td\",{staticClass:\"text-right\"},[e._v(e._s(e.receivedItems)+\"/\"),a(\"span\",[e._v(e._s(e.currentStn.totalItems))])])]),e.currentStn?a(\"tr\",[a(\"th\",{staticClass:\"text-left\"},[e._v(\"Current STN:\")]),a(\"td\",{staticClass:\"text-right\"},[e._v(e._s(e.currentStn.stn_number))])]):e._e(),e.currentStn.MasterBag?a(\"tr\",[a(\"th\",{staticClass:\"text-left\"},[e._v(\"Current Bag:\")]),a(\"td\",{staticClass:\"text-right\"},[e._v(e._s(e.currentStn.MasterBag))])]):e._e(),e.currentStn.MasterBag?a(\"tr\",[a(\"th\",{staticClass:\"text-left\"},[e._v(\"Created By:\")]),a(\"td\",{staticClass:\"text-right\"},[e._v(e._s(e.currentStn.created_by))])]):e._e()])])]):e._e()])],1)},s=[];n._withStripped=!0;var r=a(\"7037\"),c=a.n(r),o=(a(\"6762\"),a(\"ac6a\"),a(\"cadf\"),a(\"456d\"),a(\"bc3a\")),i=a.n(o),l=a(\"bc9b\"),d=a(\"c604\"),u=a(\"62a9\"),m=a(\"66d7\"),v=a(\"7b38\"),g=a(\"53fe\"),f=a(\"0952\"),b=a(\"7646\"),p=a(\"6580\"),S=a(\"5931\"),_=a(\"2f48\"),I=a(\"6186\"),C=a(\"7051\"),h=a(\"2a70\"),B=a(\"133b\"),M=a(\"206e\"),D={components:{QTable:d[\"a\"],QTh:u[\"a\"],QTr:m[\"a\"],QTd:v[\"a\"],QTableColumns:g[\"a\"],QModal:f[\"a\"],QCard:b[\"a\"],QCardTitle:p[\"a\"],QSelect:S[\"a\"],QUploader:_[\"a\"],QSearch:I[\"a\"],QLayout:C[\"a\"],QModalLayout:h[\"a\"],QToggle:l[\"a\"],Notify:B[\"a\"],QInnerLoading:M[\"a\"]},data:function(){return{typeOptions:[{label:\"RTO\",value:\"RTO\"},{label:\"Returns\",value:\"Returns\"}],modelType:\"RTO\",scanLabel:\"Scan Packet *\",locationLoader:!1,currentScannedItemLocation:\"\",scannedItem:\"\",scannedMBag:\"\",scanBagAlone:0,mbagselected:0,receivedItems:0,firsttoggle:1,pageLoading:!0,errorMsg:!1,colorOfItemLocation:\"\",tempcurrentScannedItemLocation:\"\",tempColorDict:{},currentStn:{},firstItemtoggle:1,scanItemAlone:0}},mounted:function(){var e=this;e.$refs.scannedMBag.focus(),firebase.auth().onAuthStateChanged(function(t){t?firebase.database(app2).ref(\"UserDetails/\"+t.uid).once(\"value\",function(t){e.currentUserDetails=t.val()}):e.$router.push(\"/\")}),e.pageLoading=!1},methods:{getMbagDetails:function(){var e=this,t=[\"Dispatched\",\"Partially Received\",\"open\",\"closed\"];firebase.database(app2).ref(\"StnMasterBagMapping/\"+this.scannedMBag).once(\"value\",function(a){if(a.val()){var n=Object.keys(a.val())[0],s=a.val()[n].bag_src,r=e.scannedMBag;firebase.database(app2).ref(\"StnCartonItemData/\"+s+\"/\"+n).once(\"value\",function(a){if(a.val())if(t.includes(a.val().status)){firebase.database(app2).ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/\"+r).once(\"value\",function(t){t.val()&&\"created\"===t.val().status&&(firebase.database(app2).ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/\"+r).update({status:\"Partially Received\",received_by:e.$store.state.example.userName,received_at:new Date}),firebase.database(app2).ref(\"StnCartonItemData/\"+s+\"/\"+n+\"/received_bag_count\").set(a.val().received_bag_count?a.val().received_bag_count+1:1))}),e.scanBagAlone?(B[\"a\"].create({message:e.scannedMBag+\"has been received\",position:\"center\",timeout:80,type:\"positive\",color:\"positive\",textColor:\"black\"}),e.scannedMBag=\"\"):(e.mbagselected=1,e.currentStn=a.val(),e.currentStn.Source=s,e.currentStn.received_bag_count=e.currentStn.received_bag_count?e.currentStn.received_bag_count:1,e.currentStn.received_item_count=e.currentStn.received_item_count?e.currentStn.received_item_count:0,e.receivedItems=e.currentStn.received_item_count?e.currentStn.received_item_count:0,e.currentStn.MasterBag=e.scannedMBag,setTimeout(function(){e.$refs.scannedItem.focus()},200));var c={mbag:r,src:s,stn:n,user_obj:e.currentUserDetails};i.a.post(baseUrlForBackend+\"/stn/mbag/receive\",c).then(function(e){console.log(e)})}else{var o=new Audio(\"/statics/beep1.mp3\");o.play(),B[\"a\"].create({message:\"Current Status :\"+a.val().status,position:\"center\",timeout:80}),e.scannedMBag=\"\",e.$refs.scannedMBag.focus()}})}else{var c=new Audio(\"/statics/beep1.mp3\");c.play(),B[\"a\"].create({message:\"Invalid Carton ID\",position:\"center\",timeout:80}),e.scannedMBag=\"\",e.$refs.scannedMBag.focus()}})},getDetails:function(){var e=this;e.tempcurrentScannedItemLocation=e.currentScannedItemLocation,e.locationLoader=!0,e.currentScannedItemLocation=\"\";var t=this.currentUserDetails.location_id,a=e.scannedItem;firebase.database().ref(\"RtoandReturns/\"+a+\"/\"+t).once(\"value\",function(t){if(t.val()){if(!e.tempcurrentScannedItemLocation&&t.val())e.tempColorDict[t.val()]=\"text-positive\";else if(e.tempcurrentScannedItemLocation==t.val())e.colorOfItemLocation=e.tempColorDict[t.val()];else if(e.tempcurrentScannedItemLocation!=t.val())if(\"text-positive\"==e.colorOfItemLocation){e.tempColorDict[t.val()]=\"text-light-blue-8\";var a=new Audio(\"/statics/beep2.mp3\");a.play()}else{e.tempColorDict[t.val()]=\"text-positive\";var n=new Audio(\"/statics/beep2.mp3\");n.play()}e.colorOfItemLocation=e.tempColorDict[t.val()],e.currentScannedItemLocation=t.val(),e.tempcurrentScannedItemLocation=t.val(),e.scannedItem=\"\",e.errorMsg=!1}else{e.errorMsg=!0;var s=new Audio(\"/statics/beep1.mp3\");s.play(),e.scannedItem=\"\"}e.locationLoader=!1})},receiveItem:function(){var e=this,t=e.scannedItem;1===e.scanItemAlone?e.getDetails():firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.source_code+\"/\"+e.currentStn.stn_number+\"/\"+e.currentStn.MasterBag+\"/item_code/\"+e.scannedItem).once(\"value\",function(a){if(a.val())if(\"received\"===a.val().status)e.getDetails(),firebase.database().ref(\"RtoandReturns/\"+e.scannedItem+\"/stn\").set(null),firebase.database().ref(\"RtoandReturns/\"+e.scannedItem+\"/mbag\").set(null),firebase.database().ref(\"RtoandReturns/\"+e.scannedItem+\"/location\").set(e.currentUserDetails.location_id);else{firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.source_code+\"/\"+e.currentStn.stn_number+\"/\"+e.currentStn.MasterBag+\"/item_code/\"+t).update({status:\"received\",received_by:e.$store.state.example.userName,received_at:new Date}),e.resiprocate(t),e.receivedItems+=1,e.currentStn.totalItems===e.receivedItems?firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/status\").set(\"Received\"):firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/status\").set(\"Partially Received\"),firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/\"+e.currentStn.MasterBag).once(\"value\",function(t){firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/\"+e.currentStn.MasterBag+\"/receivedItems\").set(t.val().receivedItems+1)}),firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.Source+\"/\"+e.currentStn.stn_number+\"/received_item_count\").set(e.receivedItems),firebase.database().ref(\"RtoandReturns/\"+e.scannedItem+\"/stn\").set(null),firebase.database().ref(\"RtoandReturns/\"+e.scannedItem+\"/mbag\").set(null),e.getDetails();var n={item:t,src:e.currentStn.source_code,stn:e.currentStn.stn_number,mbag:e.currentStn.MasterBag,user_obj:e.currentUserDetails};i.a.post(baseUrlForBackend+\"/stn/mbag/receive/item\",n).then(function(e){console.log(e)})}else{var s=new Audio(\"/statics/beep1.mp3\");s.play(),B[\"a\"].create({message:\"Item Not Found\",position:\"center\",timeout:80}),e.scannedItem=\"\"}})},resiprocate:function(e){var t=this;firebase.database().ref(\"RtoandReturns/\"+e).once(\"value\",function(a){var n=a.val(),s={};s[a.key]=a.val(),s[a.key][\"received_at\"]=(new Date).getTime();var r=n.location,o=n;o.location=t.currentUserDetails.location_id;var i={};\"object\"==c()(n[\"barcode\"])?n[\"barcode\"].forEach(function(e){i[e]=o,i[e].barcode=null,i[e].received_at=(new Date).getTime()}):(i[n.barcode]=o,i[n.barcode].received_at=(new Date).getTime()),\"DC\"==r?firebase.database().ref(\"ReturnedItems/\"+e).remove():firebase.database().ref(r+\"ReturnedItems/\"+e).remove(),firebase.database().ref(o.location+\"ReturnedItems\").update(s),firebase.database().ref(\"RtoandReturns\").update(i)})},closeMBag:function(){var e=this;firebase.database(app2).ref(\"StnCartonItemData/\"+e.currentStn.source_code+\"/\"+e.currentStn.stn_number+\"/\"+e.currentStn.MasterBag+\"/item_code\").once(\"value\",function(t){var a=t.numChildren(),n=0,s=\"\";t.forEach(function(e){\"received\"===e.val().status&&(n+=1)}),s=a===n?\"closed\":\"open\";var r=e.currentStn.Source,c=e.currentStn.stn_number,o=e.currentStn.MasterBag;firebase.database(app2).ref(\"StnCartonItemData/\"+r+\"/\"+c+\"/\"+o+\"/status\").set(s),e.scannedItem=\"\",e.scannedMBag=\"\",setTimeout(function(){e.$refs.scannedMBag.focus(),e.errorMsg=!1},100),e.currentStn={},e.mbagselected=0})},toggleBagScan:function(){if(this.firsttoggle&&(this.firsttoggle=0,this.scanBagAlone=!this.scanBagAlone),!0===this.scanBagAlone){this.scanItemAlone=!1;var e=this;setTimeout(function(){e.$refs.scannedMBag.focus()},500)}this.$refs.scannedMBag.focus()},toggleItemScan:function(){this.firstItemtoggle&&(this.firstItemtoggle=0,this.scanItemAlone=!this.scanItemAlone);var e=this;setTimeout(function(){e.scanItemAlone?e.$refs.scannedItem.focus():e.$refs.scannedMBag.focus()},500)}}},x=D,y=a(\"2877\"),R=Object(y[\"a\"])(x,n,s,!1,null,null,null);R.options.__file=\"rto.vue\";t[\"default\"]=R.exports}}]);","extractedComments":[]}